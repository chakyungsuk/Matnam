<?xml version="1.0" encoding="UTF-8" ?>
 
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.jeonguggu.matnam.user.chat.ChatMpp">

    <resultMap id="resultMapObj" type="com.jeonguggu.matnam.user.chat.Chat"></resultMap>
	
    <!-- 친구목록 조회 시작 -->
	<select id="selectListFriend" resultMap="resultMapObj">
		<!-- SELECT
			a.mnMmSeq
			,a.mnMmName
			,a.mnMmIntroduce
			,b.mnfdFriendSeq AS sendFriendSeq
    		,c.mnfdFriendSeq AS receiveFriendSeq
		FROM
			matnamMember a
			LEFT JOIN matnamFriend b ON b.mnfdDelNy = 0 AND a.mnMmSeq = b.mnfdFriendSeq AND b.mnfdFriendStateCd = 4
			LEFT JOIN matnamFriend c ON c.mnfdDelNy = 0 AND a.mnMmSeq = c.mnMmSeq AND c.mnfdFriendStateCd = 4
		WHERE 1=1
			AND b.mnMmSeq = #{mnMmSeq}
			OR c.mnfdFriendSeq = #{mnMmSeq} -->
		SELECT
			b.mnfdSeq
			,a.mnMmName
			,a.mnMmIntroduce
		    ,b.mnMmSeq
		    ,b.mnfdFriendSeq
		FROM
			matnamFriend b
		    LEFT JOIN matnamMember a ON b.mnMmSeq = a.mnMmSeq OR b.mnfdFriendSeq = a.mnMmSeq
		WHERE 1=1
			AND NOT a.mnMmName = #{mnMmName}
			AND b.mnMmSeq = #{mnMmSeq}
			AND b.mnfdFriendStateCd = 4
		    OR b.mnfdFriendSeq = #{mnMmSeq}
		    AND NOT a.mnMmName = #{mnMmName}
			AND b.mnfdFriendStateCd = 4
	</select>
	<!-- 친구 목록 조회 끝 -->
	
</mapper>